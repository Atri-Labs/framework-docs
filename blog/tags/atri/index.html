<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.22">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Atri Labs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Atri Labs Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Atri Labs" href="/opensearch.xml"><title data-rh="true">2 posts tagged with &quot;atri&quot; | Atri Labs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.atrilabs.com/blog/tags/atri"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="2 posts tagged with &quot;atri&quot; | Atri Labs"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.atrilabs.com/blog/tags/atri"><link data-rh="true" rel="alternate" href="https://docs.atrilabs.com/blog/tags/atri" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.atrilabs.com/blog/tags/atri" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Z9I0IHDCQY-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.3520959e.css">
<link rel="preload" href="/assets/js/runtime~main.e313f5f3.js" as="script">
<link rel="preload" href="/assets/js/main.3614417f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Atri Labs Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Atri Labs Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Atri Labs</b></a><a class="navbar__item navbar__link" href="/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/tutorials/bkg_swapper">Tutorials</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Atri-Labs/atrilabs-engine" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/journey-atri">My journey of creating a web framework like NextJS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/welcome">Welcome</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>2 posts tagged with &quot;atri&quot;</h1><a href="/blog/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/journey-atri">My journey of creating a web framework like NextJS</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-02-07T00:00:00.000Z" itemprop="datePublished">February 7, 2023</time> · <!-- -->6 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/cruxcode" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/cruxcode.png" alt="Shyam Swaroop"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/cruxcode" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shyam Swaroop</span></a></div><small class="avatar__subtitle" itemprop="description">Creator of Atri framework</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Many situations demand certain portion of the website to be easily editable by employees who do not know how to code. At the same time, developers need to code the complicated portion of the website. We have seen many companies juggling between NextJS and Webflow and cooking up hacks such as deploying different portions of their website in different domains.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-did-i-learn-from-the-nextjs-repo-before-i-started-out-creating-my-framework">What did I learn from the NextJS repo before I started out creating my framework?<a class="hash-link" href="#what-did-i-learn-from-the-nextjs-repo-before-i-started-out-creating-my-framework" title="Direct link to heading">​</a></h2><p>I was more focused on how things are working under the hood during dev time. Creating a build is easy, but, creating a dev server with the development experience same as NextJS was challenging.</p><p>NextJS runs three webpack compilers concurrently during development - one for app, one for server and one for edge runtime. We can ignore the edge runtime compiler for the time being.</p><ul><li><p>The compiler for app creates webpack runtime chunk that also has the react related libraries in it. It also creates a bundle for each page that runs on client side to hydrate the DOM. This bundle for a page, when runs in the client, adds a new route in the NextJS router. The Link component from <code>next/link</code> waits for the bundle of page to load and run before navigating to the new page. The compiler for app has a accompanying webpack-dev-server like server while we don’t need any such server for the compiler for server.</p></li><li><p>The compiler for server creates a JS bundle for each page that is run on the server side to produce HTML that can be sent to the browser upon a first request. For example, when a GET request for /careers is received by the server, the server will create a JS bundle for the career page if not already created and run that JS bundle on the server side to get the HTML string to be sent to the browser. If the career page has changes, then it first deletes the career page from require.cache and reloads it when the compilation has finished.</p></li></ul><p>NextJS does not use webpack-dev-server. Instead, it has it’s own version of webpack-dev-server where it uses packages like webpack-dev-middleware and webpack-hot-middleware.</p><p>The NextJS server handles six types of requests during development -</p><ol><li>Request for HTML upon first request (referred to as page request from here on).</li><li>Request for JS that can hydrate the HTML on the client (referred to as JS request from here on).</li><li>Request for JSON that has the data needed during hydration. This data comes from getStaticProps, getServerSideProps functions.</li><li>Request for API routes.</li><li>Request for assets such as CSS files.</li><li>Request for HMR hot update files.</li></ol><p>The entry field in webpack configuration of compilers is an async function that adds new pages in the entry “on-demand”. By “on-demand”, it is meant that a page is compiled only when a request for that page arrives to the NextJS server. Upon receiving a request for page that has not been compiled already, the NextJS server calls <code>compiler.wataching.invalidate()</code>. Upon an invalidate call, webpack runs the entry async function again to get new entries.</p><p>Other minor details that helped:</p><ul><li>The NextJS compilers relies heavily on using a loader with query as entry points.</li><li>The _document.jsx file is only used to render the page on the server side and is never sent to the client side.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-the-similarities-between-nextjs-framework-and-atri-framework">What are the similarities between NextJS framework and Atri framework?<a class="hash-link" href="#what-are-the-similarities-between-nextjs-framework-and-atri-framework" title="Direct link to heading">​</a></h2><ul><li>The Atri framework follows the same page directory convention with minor inspirations from the remix framework such as dynamic segments are not represented using <code>[ ]</code> but <code>$</code>.</li><li>The internal process during development is almost similar. Like NextJS we rely heavily on webpack’s features such as dynamic entry, loder entry with query etc.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-has-atri-implemented-its-development-server">How has Atri implemented it’s development server?<a class="hash-link" href="#how-has-atri-implemented-its-development-server" title="Direct link to heading">​</a></h2><p>The Atri framework has three webpack configs for all it’s needs:</p><ol><li>Config that creates a browser app. This is used for compiling JS bundles that hydrate the DOM in the browser.</li><li>Config that creates a NodeJS library. This is used for compiling JS bundles that are run in the server to create HTML string.</li><li>Config that create a NodeJS app. The code for development server is in TS/TSX, hence, we cannot run it in NodeJS until it’s compiled to JS. A simple compiler like <code>tsc</code> would have worked but I wanted a more uniform build process for the React code running in frontend and backend.</li></ol><p>The development server has to act on following events:</p><ol><li>Network request - Mostly from browser.</li><li>File System changes - Watching the pages directory etc.</li><li>Webpack compiler events - Webpack emits events such as “done”, “invalid” etc.</li></ol><p>Since there are diverse sources of events, it was quite complicated to have the development server in a deterministic state at all times. Hence, Atri framework uses an awesome state management library called XState.</p><p>The state contains a <code>routeObjectPaths</code> field that essentially represents the page directory in react router format i.e. <code>/pages/carrers/$id.js</code> will be represented as <code>/careers/$id</code>. When file system change event is emitted, the route configuration is updated but no compilation is triggered. A compilation is triggered only when a newtork request for a page arrives.</p><p>The server is in ready state only after:</p><ol><li>The pages directory has been scanned and route configuration has been updated.</li><li>The app compiler and server compiler has completed an initial compilation. Initially, no pages are compiled unless a request for a page arrives.</li></ol><p>All the network requests before server enters into ready state is saved in <code>requests</code> field. For each request, the triplet (Request, Response, NextFunction) is saved. These requests will be processed once the server is ready. The requests for HMR hot updates are handled directly by the webpack-dev-server, otherwise, all other requests are handled by the Atri framework.</p><p>A network request is processed only if the server is in idle state. A page request can be handled in two ways:</p><ol><li>If the page is already compiled, then it will be served.</li><li>If the page is not compiled, the request will be put in a separate queue called <code>requestReservoir</code>.</li></ol><p>While NextJS has it’s own router, Atri framework uses the router from <code>react-router-dom</code> internally. The last piece that was needed to be figured out was Link component. Whenever a Link component is clicked, the on-click handler first checks if the link already exists in the router’s configuration on the client side otherwise it will fetch the client side JS by hitting the link “/atri/js/pages${path_to_page}”. This link serves a JS file for that page built with the app compiler.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>Needless to say, creating Atri framework has been an incredible learning experience for me. </p><p>If you&#x27;re interested, try out Atri framework and share your feedback!</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/atri">atri</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/web-framework">web-framework</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/full-stack">full-stack</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/nextjs">nextjs</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/visual-builder">visual-builder</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/python">python</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/welcome">Welcome</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-08-26T00:00:00.000Z" itemprop="datePublished">August 26, 2021</time> · <!-- -->0 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/cruxcode" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/cruxcode.png" alt="Shyam Swaroop"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/cruxcode" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Shyam Swaroop</span></a></div><small class="avatar__subtitle" itemprop="description">Creator of Atri framework</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/atri">atri</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/framework">framework</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/visual-designer">visual-designer</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/python">python</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/web">web</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/atricommunity/shared_invite/zt-1e756m1at-bZBxngvw7KWWO0riI4pc0w" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/atri" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Atri-Labs/atrilabs-engine" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/atri-labs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/atrilabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Pulastya, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e313f5f3.js"></script>
<script src="/assets/js/main.3614417f.js"></script>
</body>
</html>